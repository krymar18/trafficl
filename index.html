<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Email Info</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body { font-family: sans-serif; font-size: 13px; padding: 12px; }
    h3 { margin: 10px 0 4px; font-size: 13px; color: #555; text-transform: uppercase; }
    p { margin: 0 0 8px; }
    ul { margin: 0 0 8px; padding-left: 18px; }
    li { margin-bottom: 2px; }
    #status { color: #999; font-style: italic; }
  </style>
</head>
<body>
  <p id="status">Loading...</p>
  <div id="content" style="display:none">
    <h3>Subject</h3>
    <p id="subject"></p>

    <h3>From</h3>
    <p id="from"></p>

    <h3>To</h3>
    <ul id="to"></ul>

    <h3>CC</h3>
    <ul id="cc"></ul>

    <h3>Attachments</h3>
    <ul id="attachments"></ul>
  </div>

  <script>
    Office.onReady(function () {
      var item = Office.context.mailbox.item;

      document.getElementById("subject").textContent = item.subject || "(no subject)";
      document.getElementById("from").textContent = item.from
        ? item.from.displayName + " <" + item.from.emailAddress + ">"
        : "N/A";

      function renderList(id, arr) {
        var ul = document.getElementById(id);
        if (!arr || arr.length === 0) {
          ul.innerHTML = "<li style='color:#999'>None</li>";
        } else {
          arr.forEach(function (r) {
            var li = document.createElement("li");
            li.textContent = r.displayName + " <" + r.emailAddress + ">";
            ul.appendChild(li);
          });
        }
      }

      renderList("to", item.to);
      renderList("cc", item.cc);

      var attachments = item.attachments;
      var ul = document.getElementById("attachments");
      if (!attachments || attachments.length === 0) {
        ul.innerHTML = "<li style='color:#999'>None</li>";
      } else {
        attachments.forEach(function (a) {
          var li = document.createElement("li");
          li.textContent = a.name + " (" + a.attachmentType + ")";
          ul.appendChild(li);
        });
      }

      document.getElementById("status").style.display = "none";
      document.getElementById("content").style.display = "block";
    });
  </script>
</body>
</html>
